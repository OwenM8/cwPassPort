<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PassPort | The Developer's Passkey SDK</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <script src="https://passportbycw.netlify.app/sdk.js"></script>
</head>
<body>

    <nav>
        <div class="container">
            <span class="logo">ðŸ”‘ PassPort</span>
            <div class="nav-links">
                <a href="#demo">Live Demo</a>
                <a href="docs.html" class="docs-link">See Docs</a>
                <a href="#" class="nav-cta">Get API Key</a>
            </div>
        </div>
    </nav>

    <header class="hero">
        <div class="container">
            <div class="badge">CDN Status: <span id="cdn-status">Checking...</span></div>
            <h1>Authentication that <span class="highlight">feels like magic.</span></h1>
            <p>The lightweight SDK that replaces passwords with biometrics. Hosted on Netlify Edge for global performance.</p>
            <div class="hero-btns">
                <a href="#demo" class="btn-primary">Try the Demo</a>
                <a href="docs.html" class="btn-secondary">Read the Docs</a>
            </div>
        </div>
    </header>

    <section id="demo" class="demo-section">
        <div class="container">
            <div class="section-header">
                <h2>Proof of Concept</h2>
                <p>This demo is powered by the <code>sdk.js</code> file hosted on your Netlify CDN.</p>
            </div>
            
            <div class="auth-card">
                <div id="demo-ui">
                    <div class="input-wrapper">
                        <input type="email" id="user-email" placeholder="Enter your email">
                    </div>
                    <button id="demo-register" class="btn-action">Create Passkey</button>
                    <button id="demo-login" class="btn-action outline">Verify Passkey</button>
                    
                    <div id="status-msg" class="status">Waiting for interaction...</div>
                    
                    <div id="payload-display" class="payload-box" style="display: none;">
                        <h4>Cryptographic Response:</h4>
                        <pre><code id="payload-text"></code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // Check if CDN loaded correctly
        window.addEventListener('load', () => {
            const statusBadge = document.getElementById('cdn-status');
            if (window.passport) {
                statusBadge.innerText = "ðŸŸ¢ Operational";
                statusBadge.style.color = "#22d3ee";
            } else {
                statusBadge.innerText = "ðŸ”´ Offline";
                statusBadge.style.color = "#f87171";
            }
        });

        const status = document.getElementById('status-msg');
        const payloadBox = document.getElementById('payload-display');
        const payloadText = document.getElementById('payload-text');

        // DEMO REGISTER
        document.getElementById('demo-register').addEventListener('click', async () => {
            const email = document.getElementById('user-email').value || "visitor@example.com";
            status.innerText = "Contacting Authenticator...";
            
            try {
                // CALLING THE SDK FROM YOUR CDN
                const cred = await passport.register(email);
                
                status.innerHTML = "âœ… <b>Passkey Created!</b>";
                payloadBox.style.display = "block";
                // Show the raw ID as proof of work
                payloadText.innerText = JSON.stringify({
                    id: cred.id,
                    type: cred.type,
                    clientDataJSON: "verified"
                }, null, 2);

            } catch (err) {
                status.innerText = "Error: " + err.message;
            }
        });

        // DEMO LOGIN
        document.getElementById('demo-login').addEventListener('click', async () => {
            status.innerText = "Verifying Identity...";
            try {
                const assertion = await passport.login();
                status.innerHTML = "ðŸš€ <b>Authenticated!</b> Welcome back.";
                payloadBox.style.display = "block";
                payloadText.innerText = "Signature Verified Successfully.";
            } catch (err) {
                status.innerText = "Auth failed: " + err.message;
            }
        });
    </script>

</body>
</html>
